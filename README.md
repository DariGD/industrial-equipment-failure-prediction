# Predictive Maintenance for Industrial Equipment

Автор: Гайдукова Дарья Дмитриевна

## Описание проекта

Проект посвящён предиктивному обнаружению отклонений в работе промышленного оборудования.

_Цель проекта_ — разработать модель машинного обучения для прогнозирования неисправностей оборудования на основе данных с промышленных сенсоров (температура, давление, вибрация и т.д.).

Предиктивная аналитика позволяет:

- заранее выявлять потенциальные сбои,
- сокращать простой оборудования,
- снижать затраты на обслуживание и ремонт.

Предлагаемая модель решает задачу бинарной классификации состояния оборудования:

- 0 — оборудование исправно

- 1 — оборудование неисправно

### Формат входных и выходных данных

_Входные данные_

Данные представлены в формате CSV и содержат следующие признаки:

| Признак        | Описание                                                     |
| -------------- | ------------------------------------------------------------ |
| Temperature    | Температура                                                  |
| Pressure       | Давление                                                     |
| Vibration      | Уровень вибрации                                             |
| Humidity       | Влажность                                                    |
| Equipment_Type | Тип оборудования (compressor, turbine, pump)                 |
| Location       | Локация (Atlanta, Chicago, Houston, New York, San Francisco) |
| Faulty         | Целевая метка (0 / 1)                                        |

_Выходные данные модели_

- вероятность неисправности оборудования (probability)

- предсказанный класс (0 или 1)

### Метрики качества

В датасете наблюдается сильный дисбаланс классов (неисправности встречаются менее чем в 20% случаев), поэтому используются следующие метрики:

- **F1-score**

- **Precision**

- **Recall**

- **ROC-AUC**

**Основной метрикой для итоговой оценки является ROC-AUC**
Особое внимание уделяется метрикам Recall и F1-score, так как ложноотрицательные предсказания наиболее критичны для задачи.

### Валидация и тест

Для оценки качества моделей используется Stratified K-Fold Cross-Validation, которая выполняет роль как валидации, так и тестирования:

1. данные разбиваются на K фолдов с сохранением пропорций классов

2. каждый фолд используется как валидационная выборка

3. метрики усредняются по всем фолдам

4. фиксируется random_state для воспроизводимости результатов

Данные

Источник: [[Kaggle — Industrial Equipment Monitoring Dataset]](https://www.kaggle.com/datasets/dnkumars/industrial-equipment-monitoring-dataset/data)

- Количество записей: 7 673

- Количество признаков: 7

- Типы оборудования: компрессор, турбина, насос

- Локации: Atlanta, Chicago, Houston, New York, San Francisco

Распределение классов:

- 0 — 6 900 записей

- 1 — 768 записей

Данные версионируются с помощью **DVC** и хранятся в удалённом хранилище (Google Drive).

## Моделирование

Бейзлайн-модель

В качестве бейзлайна используется модель классического машинного обучения: логистическая регрессия или градиентный бустинг.

поддержка class weighting для работы с дисбалансом классов,

используется для сравнения с нейросетевыми подходами.

Основная модель

Основная модель — нейронная сеть на PyTorch для табличных данных.

```
nn.Sequential(
            nn.Linear(input_dim, hidden_dims[0]),
            nn.BatchNorm1d(hidden_dims[0]),
            nn.ReLU(),
            nn.Dropout(dropout),
            nn.Linear(hidden_dims[0], hidden_dims[1]),
            nn.ReLU(),
            nn.Dropout(dropout),
            nn.Linear(hidden_dims[1], 1)
)
```

## Техническая часть

Структура проекта

```
├───.dvc
├───.ruff_cache
│
├───configs
│   ├───data
│   ├───logging
│   ├───model
│   └───training
├───industrial_failure
│   ├───data
│   │   └───__pycache__
│   ├───inference
│   ├───models
│   │   └───__pycache__
│   ├───training
│   │   └───__pycache__
│   ├───utils
│   │   └───__pycache__
│   └───__pycache__
├───mlruns
│   └───models
├───outputs
└───scripts
```

### Setup

1. Склонировать репозиторий:

```
git clone https://github.com/DariGD/industrial-equipment-failure-prediction
cd industrial-equipment-failure-prediction
```

2. Задать окружение:

```
python -m venv venv
venv\Scripts\activate      # Windows
source venv/bin/activate  # Linux / macOS
```

3. Установить зависимости через poetry и активировать его:

```
poetry install
poetry shell
```

4. Загрузить датсет из облачного хранилища:

```
dvc pull
```

5. Проверить, что код проходит проверку pre-commit:

```
pre-commit run -a
```

6. Поднять MLflow сервер для отслеживания экспериментов и логирования:

```
mlflow ui --port 8080
```

### Train

Обучение модели реализовано с использованием PyTorch Lightning,логирование через MLflow.

Все основные гиперпараметры задаются через конфиги в папке configs/. Управление через Hydra.

Для запуска обучения baseline модели (по дефолту в конфиге указана LogisticRegression, но поддерживается замена на XGboost) необходимо выполнить код ниже. Метрики и параметры обучения отображаются на локальном сервере MLFlow по ссылке http://127.0.0.1:8080.

```
poetry run python -m industrial_failure.training.train_baseline
```

Для запуска основной нейросетевой модели используется команда:

```
poetry run python -m industrial_failure.training.train_nn
```

При запуске комманды автоматически выполняется:

1. Загрузка данных через DVC

2. Инициализация модели

3. Обучение с использованием PyTorch Lightning

4. Логирование лосса и метрик

5. Сохранение чекпоинта модели
